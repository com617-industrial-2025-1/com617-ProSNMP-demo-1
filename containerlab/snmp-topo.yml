name: snmp-test-lab

mgmt:
  network: snmp-lab-net-v2  # Brand new name
  ipv4-subnet: 172.41.0.0/24  # New subnet

topology:
  nodes:
    snmp-device-1:
      kind: linux
      image: alpine:latest
      exec:
        - echo 'nameserver 8.8.8.8' > /etc/resolv.conf
        - apk update
        - apk add net-snmp net-snmp-tools
        - echo 'rocommunity public' > /etc/snmp/snmpd.conf
        - echo 'sysLocation "Containerlab Device 1"' >> /etc/snmp/snmpd.conf
        - echo 'sysContact admin@example.com' >> /etc/snmp/snmpd.conf
        - echo 'sysName snmp-device-1' >> /etc/snmp/snmpd.conf
        - snmpd -C -c /etc/snmp/snmpd.conf

    snmp-device-2:
      kind: linux
      image: alpine:latest
      exec:
        - echo 'nameserver 8.8.8.8' > /etc/resolv.conf
        - apk update
        - apk add net-snmp net-snmp-tools
        - echo 'rocommunity public' > /etc/snmp/snmpd.conf
        - echo 'sysLocation "Containerlab Device 2"' >> /etc/snmp/snmpd.conf
        - echo 'sysContact admin@example.com' >> /etc/snmp/snmpd.conf
        - echo 'sysName snmp-device-2' >> /etc/snmp/snmpd.conf
        - snmpd -C -c /etc/snmp/snmpd.conf

    monitor:
      kind: linux
      image: alpine:latest
      exec:
        - echo 'nameserver 8.8.8.8' > /etc/resolv.conf
        - apk update
        - apk add net-snmp-tools

  links:
    - endpoints: ["snmp-device-1:eth1", "snmp-device-2:eth1"]
